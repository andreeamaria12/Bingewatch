@using Newtonsoft.Json
@using System.Collections.Generic
@{
    ViewData["Title"] = "MyList";
}
@inject ApplicationDbContext context
@inject UserManager<User> userManager

@if (User.Identity.IsAuthenticated)
{
    User user = await userManager.FindByNameAsync(User.Identity.Name);


    <table style="width:100%">
        <tr>
            <th><h1>Favorites</h1></th>
            <th><h1>Watching</h1></th>
            <th><h1>Watched</h1></th>
        </tr>
        <tr>
            @if (Model != null)
            {
               /* List<Movie> favorites = new List<Movie>();
                foreach (var favMovie in user.Favorites)
                {
                    favorites.Add(context.Movies.First(movie => movie.Id == favMovie.MovieId));
                }*/

                @foreach (var fav in Model)
                {
                    <td>
                        <div class="col-sm-6 col-md-4">
                            <div class="thumbnail">
                                <img src="@("api/images?name=" + fav.ImageUrl)" alt="..." width="100">
                                <div class="caption">
                                    <h3>@fav.Title</h3>
                                    <p><a href="/Movie/MoviePage?id=@fav.Id" class="btn btn-primary" role="button">Read more</a> <a class="btn btn-default" id="f-@fav.Id" role="button" onclick="switchFavorite(@fav.Id);">Remove from my list</a></p>
                                </div>
                            </div>
                        </div>
                    </td>
                }

            }
            else
            {
                <td><h2>You don't have any favorite movie.</h2></td>
            }
            <td>
                2
            </td>
            <td>
                3
            </td>
        </tr>

    </table>

}